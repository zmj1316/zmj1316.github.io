---
layout: post
title: PGX 项目流水账
description: "记录我在 PGX 项目开发期间的日子"
category: other
tags: [游戏开发, 记录]
imagefeature: 
comments: true
share: true
---
最近由于一些不可抗力，手头的工作闲下来了，正好写一点这个阶段的总结。首先就从这个我基本上从头开始参与的，并且有可能送终的游戏开发过程讲起吧。之后会开始写一些这个项目开发中用到和学到的东西。

<!--more-->
## 写作进度

* 18-11-03 写到哪里算哪里

##目录

* 目录
{:toc}


## 前言

因为并不是很严谨的记录，具体时间全都是错的(因为也已经过了大半年了)，内容也多少会有些出入，有缘看到的看官就当是为了项目保密做的混淆吧。
我尽量按时间顺序来写，但是同一个方面的事情我尽量连续写掉，免得看起来累，写起来也累

## 立项

12月，老板突然说要做FPS端游，果哥和峰哥花了一两个礼拜在端游引擎上面集成了 PhysX，做了个 demo。同时资深 TA 楠哥通过 PCG 生成了初版的 8x8 地图，羽爷觉得可行，就把这个大锅接下了。

## 引擎升级

MMO引擎要做FPS需要大改，大佬们大年初三就回来加班。果哥负责PhysX和动画，鲍爷 大力 蒙哥继续给天谕升级DX11；中间学习了不少经验，下面列一下印象深刻的，可能以后再找时间详细记录。

* 因为大世界问题，世界坐标下面的动画的浮点精度不够，第一人称下手和瞄具会抖动，所以果哥改成 local space 下计算了，给后面多线程渲染挖了个大坑......
* 视距太远，出现各种 z-fighting ，大力上了 reverse-z，后续基本没再出现问题了
* 特效和音效的播放需要区分材质，地表上是直接读对应位置贴图的名字，场景模型一开始是固定一种，后来参考 EA 美术大佬的经验，仿了一套 EA 的美术流程，实现了场景模型的物理材质区分
* 后来加入的舟神做了离线可见性剔除，离线计算是拿physx做的射线检查。
* 人物模型为了做换头什么的做了切分，身体法线会有接缝，拿天谕的老工具改了改，费了不少事情
* 老汉和涛哥做的 32 层地表效果拔群，可惜做的几次分享我都没去成，连 PPT 都没看到
* 涛哥给远距离树做了 imposter，缓解了我们没有 LOD 的问题 
* 楠哥的 Houdini，道路，电线杆...... 楠哥牛逼！

我毕设做的 IK 也总算是派上了用处，持枪和驾驶载具的手都是拿 IK 算的。

之前果哥先见之明，让我提前预研的基于 FBX 的美术流程，也给后来的物理模型制作流程铺了路。

新的客户端打包工具也在这时候给 PGX 部署上了，为了准备后面的内部测试和外网测试。

## 空降主策

忘了主策海灵是什么时候入职的了，大概是3月的样子吧，来了就提出要做火箭筒，榴弹，战术道具什么的。大家（起码引擎这里）开始都嗤之以鼻，因为老板给的期限好像是4月公测。不得不说团队开发效率是真高，真在首测的时候把战术道具做出来了，基本的吃鸡模式也完成了。
主策后来一直心心念念要做战马载具，引擎这里就私下叫他战马哥。直到最后那天战马哥还在执着着想做战马，也是值得佩服了。

3月这段时间，我的主要工作时间都投入到给 NV 新出的 DXRT 功能做预研去了，功能很先进。NV想让PGX做一个DXRT的demo，可惜我们刚升级到DX11，DX12？不存在的。

## 人事变动

4月份的时候，引擎开发核心的几人 蒙哥，鲍爷，大力 先后被挖走，差不多时候，鸟叔又宣布 PGX 引擎要上 DX11 版本的，所以博文大佬接下了 merge 的工作，开始把 PGX 当前的引擎和天谕 DX11 分支引擎合并。

快到5月的时候，果哥也宣布要走了，这一波直接把引擎的老团队团灭了，留下以涛哥带头的新生代团队，整个引擎弥漫着要跳槽跑路的氛围，还好后来都留下了，经过几个月的合作，团队总算是又稳固起来了，后来又有两个社招新同学加入。我虽然就一实习的，也为能保住一个归宿而高兴。

拜果哥离职丢给我的锅还有新的导出插件和美术流程所赐，我这时候才算是真的完全投入 PGX 项目当中去了，后来把 NV 的 DXRT 的 demo 也给鸽了，费了我好多时间，不过好歹是趁机了解了一些DX12的接口、NV的falcor框架，还有我们引擎的一些代码，后面还是有点用处的。

## 5月 一测 

涛哥在上线之前把Lightmap、32层都搞定了，后来线上公测的效果基本都在这时候定了

我感觉，一测就是被老板和ROE那边逼出来的，不予评价，勉强算是做出来了。。。。。。

## 7月 二测

为了性能，大佬们开始重构引擎。

说是参与，我一个小实习的也没啥关键的地方可以帮忙，除了继续完善物理导出的流程，二测之前主要工作就是在发布流程上面增加了部分数据防破解的事情，花了好多时间做了全自动化的混淆流程，结果最后也没怎么用上。

这期间对引擎 PhysX 部分做了一些工作，总算是收尾了，物理材质能实现区分了。

这之后我跑去做毕设相关的调研去了，活没干多少，都是美术那边用新的导出工具不适应，跑去当客服了，烦得要死。还有就是果哥留下的锅，帮 PGX 的客户端那边解决一些引擎方面的问题，还有我写的 IK 的问题

## 9月 公测

公测前大家各种查泄露和优化，内存显存都在漏，上线前的一天，还和鸟叔佳哥他们一起通宵查泄露，还让我查出来一个🤣。

## 没了

这部分太伤感了，等过几个月沉淀一下，可能更理智一点，现在只想日了***，就这样。 